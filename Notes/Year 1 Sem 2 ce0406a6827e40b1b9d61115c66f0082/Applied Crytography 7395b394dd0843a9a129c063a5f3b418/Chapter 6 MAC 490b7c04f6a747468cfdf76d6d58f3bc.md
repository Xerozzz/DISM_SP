# Chapter 6: MAC

Created: Feb 1, 2020 9:38 PM
Updated: Feb 1, 2020 10:12 PM

**Content:**

- What is Message Authentication Code (MAC)
- MAC function requirements
- Application of MAC
- Hash based MAC (HMAC)
- Symmetric cipher based MAC, Data Authentication Algorithm (DAA)

**Message Authentication Code (MAC):**

What is MAC?

- MAC is short for Message Authentication Code
- MAC is a cryptographic checksum of message
- MAC provides message authentication by validating the sender of the message
- Generated by an algorithm that creates a small fixed-size block
- Appended to message as a "signature"
- Receiver performs same computations on a message and checks to match MAC
- Provides assurance that message is unaltered and comes from a particular sender
- When using MAC, both sender and receiver share common secret key
- Receiver verify the message by regenerating the MAC and comparing against sent MAC

MAC Requirements:

![Chapter%206%20MAC%20490b7c04f6a747468cfdf76d6d58f3bc/Annotation_2020-02-01_214416.jpg](Chapter%206%20MAC%20490b7c04f6a747468cfdf76d6d58f3bc/Annotation_2020-02-01_214416.jpg)

MAC Application:

- MAC Algorithm
    - Generate a small fixed-size block called authenticator/MAC/MAC Code etc
    - Output depending on message + key
    - Need not be reversible
    - MAC appended to message, validated by receiver
- MAC with message encryption
    - For secrecy with encryption
    - Most secure to least secure
        - Encrypt then generate MAC from ciphertext
        - Generate MAC and Encrypt both MAC and message
        - Encrypt and MAC ONLY
- MAC without message encryption
    - For authentication and data integrity only

Keyed Hash Function as MAC:

- MAC algorithms based on Hash functions
    - Generally faster
    - Widely available and well understood
    - Need modification to use a key

**Hash based Message Authentication Code (HMAC)**:

Details:

- Specified as Internet standard RFC2014
- Small overhead
- No encryption computation requried
- Could use any hash function (Eg. MD5, SHA-1)

Overview:

- K+ is the Key padded with zeros on the left so the result is b bits in length
- ipad is a pad value of 0x36 repeated to fill block
- opad is pad value of 0x5C repeated to fill block
- M is message input to HMAC

[Chapter%206%20MAC%20490b7c04f6a747468cfdf76d6d58f3bc/untitled](Chapter%206%20MAC%20490b7c04f6a747468cfdf76d6d58f3bc/untitled)

Security:

- Security of HMAC relates to underlying hash algorithm
- Attacking HMAC requires either
    - Brute force attack on key used
    - Birthday attack
- MD5 is considered safe when used with HMAC

**Using Symmetric Ciphers for MACs:**

- Can use any block cipher chaining mode and use final block as a MAC
- Data Authentication Algorithm (DAA) is former US gov standard widely used for producing MAC codes
    - However, final MAC output of DAA, 64 bits checksum is now too small for security

[Chapter%206%20MAC%20490b7c04f6a747468cfdf76d6d58f3bc/untitled%201](Chapter%206%20MAC%20490b7c04f6a747468cfdf76d6d58f3bc/untitled%201)